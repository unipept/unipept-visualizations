/*! unipept-visualizations 1.1.0 19-01-2017 */
"use strict";var _typeof2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};!function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}([function(a,b,c){function d(a){return a&&a.__esModule?a:{default:a}}var e=c(1),f=(d(e),c(3));d(f)},function(a,b,c){function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==("undefined"==typeof b?"undefined":_typeof2(b))&&"function"!=typeof b?a:b}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof b?"undefined":_typeof2(b)));a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function h(a,b){function c(){G=l({},F,A),G.width=G.width-C.right-C.left,G.height=G.height-C.top-C.bottom,G.enableTooltips&&d(),G.enableInnerArcs&&h(),L=d3.layout.tree().nodeSize([2,10]).separation(function(a,b){var c=m(a)+m(b),d=c/2+4;return a.parent===b.parent?d:d+4}),N=d3.svg.diagonal().projection(function(a){return[a.y,a.x]}),O=d3.scale.linear().range([G.minNodeSize,G.maxNodeSize]),Q=d3.behavior.zoom().scaleExtent([.1,3]).on("zoom",function(){R.attr("transform","translate("+d3.event.translate+")scale("+d3.event.scale+")")}),R=d3.select(a).append("svg").attr("version","1.1").attr("xmlns","http://www.w3.org/2000/svg").attr("viewBox","0 0 "+(G.width+C.right+C.left)+" "+(G.height+C.top+C.bottom)).attr("width",G.width+C.right+C.left).attr("height",G.height+C.top+C.bottom).call(Q).append("g").attr("transform","translate("+C.left+","+C.top+")").append("g"),i(S.createNode(b))}function d(){M=d3.select("body").append("div").attr("id",a.id+"-tooltip").attr("class","tip").style("position","absolute").style("z-index","10").style("visibility","hidden").style("background-color","white").style("padding","2px").style("border","1px solid #dddddd").style("border-radius","3px;")}function h(){var a=d3.scale.linear().range([0,2*Math.PI]);P=d3.svg.arc().outerRadius(m).startAngle(0).endAngle(function(b){return a(b.data.self_count/b.data.count)||0})}function i(a){var b=this;O.domain([0,a.data.count]),K=a,K.x0=G.height/2,K.y0=0,K.setSelected(!0),K.children.forEach(function(a,c){a.color=d3.functor(G.colors).call(b,a,c),a.setRecursiveProperty("color",a.color)}),G.enableExpandOnClick?(K.collapseAll(),K.expand()):K.expandAll(),j(K),r(K)}function j(a){var b=L.nodes(K).reverse(),c=L.links(b);b.forEach(function(a){a.y=a.depth*G.nodeDistance});var d=R.selectAll("g.node").data(b,function(a){return a.id||(a.id=++J)}),e=d.enter().append("g").attr("class","node").style("cursor","pointer").attr("transform",function(b){return"translate("+(a.y||0)+","+(a.x0||0)+")"}).on("click",o).on("mouseover",s).on("mouseout",t).on("contextmenu",p);e.append("circle").attr("r",1e-6).style("stroke-width","1.5px").style("stroke",G.nodeStrokeColor).style("fill",G.nodeFillColor),G.enableInnerArcs&&e.append("path").attr("d",P).style("fill",G.nodeStrokeColor).style("fill-opacity",0),G.enableLabels&&e.append("text").attr("x",function(a){return a.isLeaf()?10:-10}).attr("dy",".35em").attr("text-anchor",function(a){return a.isLeaf()?"start":"end"}).text(G.getLabel).style("font","10px sans-serif").style("fill-opacity",1e-6);var f=d.transition().duration(D).attr("transform",function(a){return"translate("+a.y+","+a.x+")"});f.select("circle").attr("r",m).style("fill-opacity",function(a){return a._children?1:0}).style("stroke",G.nodeStrokeColor).style("fill",G.nodeFillColor),G.enableLabels&&f.select("text").style("fill-opacity",1),G.enableInnerArcs&&f.select("path").duration(D).attr("d",P).style("fill-opacity",.8);var g=d.exit().transition().duration(D).attr("transform",function(b){return"translate("+a.y+","+a.x+")"}).remove();g.select("circle").attr("r",1e-6),g.select("path").style("fill-opacity",1e-6),g.select("text").style("fill-opacity",1e-6);var h=R.selectAll("path.link").data(c,function(a){return a.target.id});h.enter().insert("path","g").attr("class","link").style("fill","none").style("stroke-opacity","0.5").style("stroke-linecap","round").style("stroke",G.linkStrokeColor).style("stroke-width",1e-6).attr("d",function(b){var c={x:a.x0||0,y:a.y0||0};return N({source:c,target:c})}),h.transition().duration(D).attr("d",N).style("stroke",G.linkStrokeColor).style("stroke-width",function(a){return a.source.selected?O(a.target.data.count)+"px":"4px"}),h.exit().transition().duration(D).style("stroke-width",1e-6).attr("d",function(b){var c={x:a.x,y:a.y};return N({source:c,target:c})}).remove(),b.forEach(function(a){var b=[a.x,a.y];a.x0=b[0],a.y0=b[1]})}function m(a){return a.selected?O(a.data.count)/2:2}function o(a){G.enableExpandOnClick&&(d3.event.defaultPrevented||(d3.event.shiftKey?a.expandAll():a.children?a.collapse():a.expand(),j(a),r(a)))}function p(a){G.enableRightClick&&q(a)}function q(a){return a===H&&a!==K?void q(K):(H=a,K.setSelected(!1),a.setSelected(!0),O.domain([0,a.data.count]),a.expand(),null!==d3.event&&d3.event.preventDefault(),j(a),void r(a))}function r(a){var b=Q.scale(),c=-a.y0,d=-a.x0;c=c*b+G.width/4,d=d*b+G.height/2,R.transition().duration(D).attr("transform","translate("+c+","+d+")scale("+b+")"),Q.scale(b),Q.translate([c,d])}function s(a,b){G.enableTooltips&&(M.html(G.getTooltip(a)).style("top",d3.event.pageY-5+"px").style("left",d3.event.pageX+15+"px"),I=setTimeout(function(){M.style("visibility","visible")},1e3))}function t(a,b){G.enableTooltips&&(clearTimeout(I),M.style("visibility","hidden"))}function u(a){return a.selected?a._children?a.color||"#aaa":"#fff":"#aaa"}function v(a){return a.selected?a.color||"#aaa":"#aaa"}function w(a){return a.source.selected?a.target.color:"#aaa"}function x(a){return"<h3 class='tip-title'>"+G.getTooltipTitle(a)+"</h3><p>"+G.getTooltipText(a)+"</p>"}function y(a){return a.name}function z(a){return a.data.count+" hits"}var A=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},B={},C={top:5,right:5,bottom:5,left:5},D=750,E=d3.scale.category10(),F={height:300,width:600,nodeDistance:180,levelsToExpand:2,minNodeSize:2,maxNodeSize:105,countAccessor:function(a){return a.data.count},colors:function(a){return E(a.name)},nodeFillColor:u,nodeStrokeColor:v,linkStrokeColor:w,enableInnerArcs:!0,enableExpandOnClick:!0,enableRightClick:!0,enableLabels:!0,getLabel:function(a){return a.name},enableTooltips:!0,getTooltip:x,getTooltipTitle:y,getTooltipText:z},G=void 0,H=void 0,I=void 0,J=0,K=void 0,L=void 0,M=void 0,N=void 0,O=void 0,P=void 0,Q=void 0,R=void 0,S=function(a){function b(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e(this,b);var c=f(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));return c.setCount(),c}return g(b,a),k(b,[{key:"setCount",value:function(){G.countAccessor(this)?this.data.count=G.countAccessor(this):this.children?this.data.count=this.children.reduce(function(a,b){return a+b.data.count},0):this.data.count=0}},{key:"setSelected",value:function(a){this.setRecursiveProperty("selected",a)}},{key:"collapseAll",value:function(){this.children&&0===this.children.length&&(this.children=null),this.children&&(this._children=this.children,this._children.forEach(function(a){a.collapseAll()}),this.children=null)}},{key:"collapse",value:function(){this.children&&(this._children=this.children,this.children=null)}},{key:"expandAll",value:function(){this.expand(100)}},{key:"expand",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:G.levelsToExpand;a>0&&(this._children&&(this.children=this._children,this._children=null),this.children&&this.children.forEach(function(b){b.expand(a-1)}))}}],[{key:"new",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new b(a)}},{key:"createNode",value:function(a){return n.default.createNode(a,b.new)}}]),b}(n.default);return B.reset=function(){Q.scale(1),q(K)},c(),B}function i(a,b){return this.each(function(){var c=$(this),d=c.data("vis.treeview"),e=$.extend({},c.data(),"object"===("undefined"==typeof b?"undefined":j(b))&&b);d||c.data("vis.treeview",d=new h(this,a,e)),"string"==typeof b&&d[b]()})}Object.defineProperty(b,"__esModule",{value:!0});var j="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(a){return"undefined"==typeof a?"undefined":_typeof2(a)}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":"undefined"==typeof a?"undefined":_typeof2(a)},k=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),l=Object.assign||function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a};b.default=h;var m=c(2),n=d(m);$.fn.treeview=i,$.fn.treeview.Constructor=h},function(a,b){function c(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(b,"__esModule",{value:!0});var d=Object.assign||function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a},e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};c(this,a),this.data={},d(this,b)}return e(a,[{key:"setRecursiveProperty",value:function(a,b){this[a]=b,this.children?this.children.forEach(function(c){c.setRecursiveProperty(a,b)}):this._children&&this._children.forEach(function(c){c.setRecursiveProperty(a,b)})}},{key:"isLeaf",value:function(){return!this.children&&!this._children||this.children&&0===this.children.length||this._children&&0===this._children.length}},{key:"getHeight",value:function(){return void 0===this._height&&(this.isLeaf()?this._height=0:this._height=d3.max(this.children,function(a){return a.getHeight()})+1),this._height}},{key:"getDepth",value:function(){return void 0===this._depth&&(void 0===this.parent?this._depth=0:this._depth=this.parent.getDepth()+1),this._depth}}],[{key:"new",value:function(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new a(b)}},{key:"createNode",value:function(b){var c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.new;return b.children&&(b.children=b.children.map(function(b){return a.createNode(b,c)})),c.call(null,b)}}]),a}();b.default=f},function(a,b,c){function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==("undefined"==typeof b?"undefined":_typeof2(b))&&"function"!=typeof b?a:b}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof b?"undefined":_typeof2(b)));a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function h(a,b){function c(){D=l({},C,z),E=M.createNode(b),D.width=D.width-B.right-B.left,D.height=D.height-B.top-B.bottom,D.levels=D.levels||E.getHeight(),D.enableTooltips&&d(),h(),i(E),m(E,!1)}function d(){K=d3.select("body").append("div").attr("id",a.id+"-tooltip").attr("class","tip").style("position","absolute").style("z-index","10").style("visibility","hidden").style("background-color","white").style("padding","2px").style("border","1px solid #dddddd").style("border-radius","3px;")}function h(){var b=D.className;$(a).addClass(b),$("<style>").prop("type","text/css").html("\n                    ."+b+" {\n                        font-family: Roboto,'Helvetica Neue',Helvetica,Arial,sans-serif;\n                    }\n                    ."+b+" .node {\n                        font-size: 9px;\n                        line-height: 10px;\n                        overflow: hidden;\n                        position: absolute;\n                        text-indent: 2px;\n                        text-align: center;\n                        text-overflow: ellipsis;\n                        cursor: pointer;\n                    }\n                    ."+b+" .node:hover {\n                        outline: 1px solid white;\n                    }\n                    ."+b+" .breadcrumbs {\n                        font-size: 11px;\n                        line-height: 20px;\n                        padding-left: 5px;\n                        font-weight: bold;\n                        color: white;\n                        box-sizing: border-box;\n                    }\n                    .full-screen ."+b+" .breadcrumbs {\n                        width: 100% !important;\n                    }\n                    ."+b+" .crumb {\n                        cursor: pointer;\n                    }\n                    ."+b+" .crumb .link:hover {\n                        text-decoration: underline;\n                    }\n                    ."+b+' .breadcrumbs .crumb + .crumb::before {\n                        content: " > ";\n                        cursor: default;\n                    }\n                ').appendTo("head")}function i(b){$(a).empty(),H=d3.layout.treemap().size([D.width+1,D.height+1]).padding([D.labelHeight,0,0,0]).value(D.countAccessor),L=d3.scale.linear().domain([0,D.levels]).range([D.colorRoot,D.colorLeaf]).interpolate(d3.interpolateLab),I=d3.select(a).append("div").attr("class","breadcrumbs").style("position","relative").style("width",D.width+"px").style("height","20px").style("background-color",D.colorBreadcrumbs),J=d3.select(a).append("div").style("position","relative").style("width",D.width+"px").style("height",D.height+"px").style("left",B.left+"px").style("top",B.top+"px")}function j(){for(var a=[],b=G;b;)a.push(b),b=b.parent;a.reverse(),I.html(""),I.selectAll(".crumb").data(a).enter().append("span").attr("class","crumb").attr("title",D.getBreadcrumbTooltip).html(function(a){return"<span class='link'>"+a.name+"</span>"}).on("click",function(a){m(a)})}function m(a){var b=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];G=a,j();var c=J.selectAll(".node").data(H.nodes(a),function(a){return a.id||(a.id=++F)});c.enter().append("div").attr("class","node").style("background",function(a){return L(D.getLevel(a))}).style("color",function(a){return x(L(D.getLevel(a)))}).style("left","0px").style("top","0px").style("width","0px").style("height","0px").text(D.getLabel).on("click",function(a){m(a)}).on("contextmenu",function(a){d3.event.preventDefault(),G.parent&&m(G.parent)}).on("mouseover",r).on("mousemove",t).on("mouseout",s),c.order().transition().call(p),c.exit().remove(),b&&D.rerootCallback&&D.rerootCallback.call(null,G)}function o(){J.selectAll(".node").data(H.nodes(b),function(a){return a.id}).order().transition().call(p)}function p(){this.style("left",function(a){return a.x+"px"}).style("top",function(a){return a.y+"px"}).style("width",function(a){return Math.max(0,a.dx-1)+"px"}).style("height",function(a){return Math.max(0,a.dy-1)+"px"})}function q(a,b){H=d3.layout.treemap().size([a+1,b+1]).padding([10,0,0,0]).value(D.countAccessor),o()}function r(a,b){D.enableTooltips&&K.html(D.getTooltip(a)).style("top",d3.event.pageY-5+"px").style("left",d3.event.pageX+15+"px").style("visibility","visible")}function s(a,b){D.enableTooltips&&K.style("visibility","hidden")}function t(a,b){D.enableTooltips&&K.style("top",d3.event.pageY-5+"px").style("left",d3.event.pageX+15+"px")}function u(a){return"<h3 class='tip-title'>"+D.getTooltipTitle(a)+"</h3><p>"+D.getTooltipText(a)+"</p>"}function v(a){return a.name}function w(a){return a.data.count+" hits"}function x(a){var b="#000";try{b=y(d3.rgb(a))<125?"#eee":"#000"}catch(a){}return b}function y(a){return.299*a.r+.587*a.g+.114*a.b}var z=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},A={},B={top:0,right:0,bottom:0,left:0},C={height:300,width:600,className:"unipept-treemap",levels:void 0,getLevel:function(a){return a.getDepth()},countAccessor:function(a){return a.data.self_count},rerootCallback:void 0,getBreadcrumbTooltip:function(a){return a.name},colorRoot:"#104B7D",colorLeaf:"#fdffcc",colorBreadcrumbs:"#FF8F00",labelHeight:10,getLabel:function(a){return a.name},enableTooltips:!0,getTooltip:u,getTooltipTitle:v,getTooltipText:w},D=void 0,E=void 0,F=0,G=void 0,H=void 0,I=void 0,J=void 0,K=void 0,L=void 0,M=function(a){function b(){return e(this,b),f(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return g(b,a),k(b,null,[{key:"new",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new b(a)}},{key:"createNode",value:function(a){return n.default.createNode(a,b.new)}}]),b}(n.default);return A.reset=function(){m(E)},A.setFullScreen=function(a){setTimeout(function(){var b=[D.width,D.height],c=b[0],d=b[1];a&&(c=$(window).width(),d=$(window).height()-44),q(c,d)},1e3)},c(),A}function i(a,b){return this.each(function(){var c=$(this),d=c.data("vis.treemap"),e=$.extend({},c.data(),"object"===("undefined"==typeof b?"undefined":j(b))&&b);d||c.data("vis.treemap",d=new h(this,a,e)),"string"==typeof b&&d[b]()})}Object.defineProperty(b,"__esModule",{value:!0});var j="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(a){return"undefined"==typeof a?"undefined":_typeof2(a)}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":"undefined"==typeof a?"undefined":_typeof2(a)},k=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),l=Object.assign||function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a};b.default=h;var m=c(2),n=d(m);$.fn.treemap=i,$.fn.treemap.Constructor=h}]);